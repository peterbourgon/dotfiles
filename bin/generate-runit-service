#!/usr/bin/env bash

if [[ $# -ne 1 ]]
then
	echo "usage: $0 <name>"
	exit
fi

NAME=$1

cat >${NAME}_run <<EOF
#!/bin/sh
exec 2>&1
exec /opt/${NAME}/${NAME} \\
  -flag value \\
  -config value 
EOF
chmod +x ${NAME}_run

cat >${NAME}_log_run <<EOF
#!/bin/sh
exec svlogd -tt /var/log/${NAME}
EOF
chmod +x ${NAME}_log_run

echo mkdir /opt/${NAME}
echo \# install /opt/${NAME}/${NAME} 
echo mkdir -p /etc/sv/${NAME}/log
echo mv ${NAME}_run /etc/sv/${NAME}/run
echo mv ${NAME}_log_run /etc/sv/${NAME}/log/run
echo ln -s /etc/sv/${NAME} /etc/service/${NAME}
echo sv status ${NAME}

